#+title: Kullu Valleys — Beas Drainage Digital Twin
#+subtitle: From Aut to Lahaul: the full biogeographic gradient
#+date: 2026-02-12

#+begin_quote
The river does not begin at its source or end at its mouth. It begins wherever the rain first strikes stone.
#+end_quote

* Scope

This is the third expansion of the Parvati Valley digital twin, now encompassing the entire Beas drainage system in Kullu district and its bounding ridgelines.

| Parameter  | Value                            |
|------------+----------------------------------|
| Latitude   | 31.40°N – 32.70°N               |
| Longitude  | 76.80°E – 78.00°E               |
| Extent     | ~145 × 113 km                   |
| SRTM tiles | N31E076, N31E077, N32E076, N32E077 |
| Elevation  | 477 – 6570 m                    |

** Boundaries

- *South*: Aut (31.53°N), where the Beas enters its gorge toward Mandi
- *North*: Lahaul (Keylong, 32.57°N), beyond Rohtang Pass into the Chenab system
- *West*: Dhauladhar / Pir Panjal ridgeline, separating Kullu from Kangra and Chamba
- *East*: Great Himalayan Range, separating Kullu from Spiti

** Progression

| Stage    | Extent     | Tiles | Vertices  | OBJ size |
|----------+------------+-------+-----------+----------|
| Peak     | 20 × 20 km  | 1     | 58K       | 6.8 MB   |
| Valley   | 39 × 84 km  | 2     | 228K      | 29 MB    |
| Expanded | 90 × 100 km | 2     | 416K      | 52 MB    |
| *Kullu*  | 145 × 113 km | 4     | 317K      | 21 MB    |

The Kullu mesh is actually smaller in OBJ size than the expanded mesh because it is /bare/ (no texture coordinates), with vertex colors applied in Blender.

* Geographic Features

** The Beas and Its Tributaries

The Beas rises near Rohtang Pass at Beas Kund (~3540 m) and flows south through the Kullu valley for ~130 km before entering the Aut gorge. Major tributaries:

| River        | Source                 | Confluence |
|--------------+------------------------+------------|
| Parvati      | Man Talai glacier      | Bhuntar    |
| Tirthan      | Tirath valley, GHNP    | Larji      |
| Sainj         | Rakti Dhar             | near Larji |
| Jiwa Nal     | GHNP interior          | joins Sainj|
| Solang Nala  | Beas Kund area         | near Manali|

** Towns and Settlements

| Town     | Lat     | Lon     | Elev (m) | Notes                           |
|----------+---------+---------+----------+---------------------------------|
| Aut      | 31.530  | 77.060  | ~800     | Southern gateway, Beas gorge    |
| Bhuntar  | 31.876  | 77.160  | ~1100    | Airport, Parvati-Beas confluence|
| Kullu    | 31.958  | 77.109  | ~1230    | District capital                |
| Naggar   | 32.112  | 77.169  | ~1760    | Old capital, Roerich estate     |
| Manali   | 32.240  | 77.189  | ~2050    | Tourism hub                     |
| Keylong  | 32.572  | 77.031  | ~3080    | Lahaul HQ, trans-Rohtang        |
| Kasol    | 32.010  | 77.315  | ~1640    | Parvati Valley                  |
| Manikaran| 32.030  | 77.348  | ~1760    | Hot springs, pilgrimage         |

** Peaks

| Peak             | Lat     | Lon     | Elev (m) |
|------------------+---------+---------+----------|
| Parvati Parbat   | 32.091  | 77.735  | 6632     |
| Indrasan         | 32.310  | 77.130  | 6221     |
| Deo Tibba        | 32.349  | 77.196  | 6001     |
| Hanuman Tibba    | 32.273  | 77.132  | 5932     |

** Passes

| Pass              | Lat     | Lon     | Elev (m) | Connects              |
|-------------------+---------+---------+----------+-----------------------|
| Rohtang           | 32.372  | 77.248  | 3978     | Kullu ↔ Lahaul        |
| Pin Parvati       | 32.070  | 77.820  | 5300     | Parvati ↔ Spiti       |
| Hamta             | 32.307  | 77.212  | 4268     | Manali ↔ Lahaul       |
| Jalori            | 31.527  | 77.370  | 3120     | Kullu ↔ Shimla        |
| Chandrakhani      | 31.979  | 77.183  | 3660     | Naggar ↔ Malana       |

* Biome Zones

The full biogeographic gradient from the Beas gorge to the glacial peaks, following the classification in =parbati-biodiversity.org=:

| Zone                         | Elevation    | Key Species                           |
|------------------------------+--------------+---------------------------------------|
| Subtropical (Chir pine)      | 1000–1800 m  | /Pinus roxburghii/, /Lantana camara/  |
| Moist Temperate (Deodar)     | 1800–2700 m  | /Cedrus deodara/, /Quercus/, rhododendron |
| Upper Temperate (Fir/Spruce) | 2700–3200 m  | /Abies pindrow/, W. Tragopan (6.5/km²) |
| Subalpine (Birch)            | 3200–3600 m  | /Betula utilis/, /Rhododendron campanulatum/ |
| Alpine Meadow                | 3600–4500 m  | /Meconopsis/, /Primula/, medicinal herbs |
| Subnival                     | 4500–5200 m  | Lichen, cushion plants, 192 lichen spp |
| Nival (Snow/Ice)             | 5200+ m      | Bare rock, permanent snow              |

The vertex color ramp in =kullu_blender.py= encodes these zones directly — each elevation band maps to a distinct colour, making the biome boundaries visible on the mesh at a glance.

** Key Fauna Markers

| Species            | IUCN Status | Habitat Elev | Notes                         |
|--------------------+-------------+--------------+-------------------------------|
| Snow Leopard       | Vulnerable  | 3500–5500 m  | 83 in HP; Pin Parvati corridor |
| Western Tragopan   | Vulnerable  | 2400–3600 m  | 6.5 birds/km² in GHNP         |
| Himalayan Brown Bear | Vulnerable | 3000–5000 m | ~20 in GHNP                   |
| Musk Deer          | Endangered  | 2500–4000 m  | Poached for musk              |
| Himalayan Monal    | LC          | 2700–4500 m  | National bird of Nepal         |
| Golden Mahseer     | Endangered  | 500–1500 m   | Lower Beas and Tirthan        |

** Protected Areas

| Area          | Est. | Area (km²) | UNESCO | Notes                              |
|---------------+------+------------+--------+------------------------------------|
| GHNP          | 1984 | 754 (core) | 2014   | 25 forest types, 832 plant spp    |
| Khirganga NP  | 2010 | 710        |        | Parvati Parbat within              |

Together with Pin Valley NP and surrounding sanctuaries: ~3000+ km² interconnected protected landscape.

* Data Sources

** DEM

- SRTM 1-arcsecond (~30 m) from AWS/Mapzen: =https://elevation-tiles-prod.s3.amazonaws.com/skadi/=
- HGT format: 3601×3601, big-endian int16, gzip-compressed
- 4 tiles: N31E076, N31E077, N32E076, N32E077
- Void value: -32768, filled via nearest-neighbour (EDT)

** Biome Classification

Elevation-based, following the zonation documented in =parbati-biodiversity.org= and Champion & Seth's forest classification system for the Western Himalaya.

* Method

** DEM Processing (=kullu_mesh.py=)

1. Download 4 SRTM tiles to =data/=
2. Stitch into 7201×7201 array (2×2 tile grid with 1-pixel overlap at seams)
3. Crop to extent → 4682×4322
4. Render hillshade with matplotlib LightSource (azimuth 315°, altitude 40°)
5. Render biome zone map (categorical colors over hillshade)
6. Subsample ×8 → 586×541 = 317,026 vertices
7. Fill NaN voids via =scipy.ndimage.distance_transform_edt=
8. Export bare OBJ (vertices + faces, no texture coordinates) + minimal MTL

** Blender Annotations (=kullu_blender.py=)

1. Import bare OBJ into Blender 5.x
2. Paint vertex colors using 15-stop elevation ramp (500–6600 m)
3. Create shader material: Attribute → Principled BSDF → Output
4. Place labeled empties: 30+ landmarks (towns, peaks, passes, valleys, protected areas)
5. Place biome zone labels as empties with cube display
6. Place species markers as empties with cone display
7. Add 3D text at Parvati Parbat summit with marker pole
8. Configure sun light (NW, 45° altitude)
9. Set viewport: clip_end 300 km, material preview, frame selection

** Coordinate System

- Origin: center of extent (32.05°N, 77.40°E)
- X: east (meters), using DEG_LON_M = 111320 × cos(32.05°)
- Y: north (meters), using DEG_LAT_M = 111320
- Z: elevation above sea level (meters)

* Results

| Output                          | Size      |
|---------------------------------+-----------|
| =data/kullu_hillshade.png=      | hillshade |
| =data/kullu_biome_map.png=      | biome map |
| =data/meshes/kullu.obj=         | 21.0 MB   |
| =data/meshes/kullu.mtl=         | <1 KB     |

Mesh statistics:
- 317,026 vertices
- 631,800 triangles
- Elevation range: 477–6570 m
- Ground resolution: ~240 m (step=8)

* Usage

#+begin_src shell
# Generate the mesh and maps
vload py310
python3 parbati/kullu/kullu_mesh.py

# Open in Blender with annotations
blender --python parbati/kullu/kullu_blender.py
#+end_src

* Notes

- The Rohtang Pass boundary places the mesh across the Pir Panjal divide. North of Rohtang is Lahaul — cold desert ecology, Chenab drainage — a fundamentally different biogeographic zone. The colour ramp still applies (it is elevation-based) but the ecological interpretation changes north of the divide.
- The western ridge includes portions of the Dhauladhar range visible from Kullu. Some cells on the far western edge dip into the Kangra valley (~500 m). These receive the lowest colour in the ramp.
- Two of the four SRTM tiles (N31E077, N32E077) were already downloaded for the expanded Parvati mesh. The Kullu mesh re-downloads them to its own =data/= directory for self-containment.
